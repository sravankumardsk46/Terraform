################  AWS CLI INSTALL ON UBUNTU OS ##################################
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
sudo apt install unzip -y && unzip awscliv2.zip
sudo ./aws/install --bin-dir /usr/bin --install-dir /usr/bin/aws_cli --update
aws --version

aws configure
$ aws configure
AWS Access Key ID [None]: YOUR_ACCESS_KEY_ID    NONAME
AWS Secret Access Key [None]: YOUR_SECRET_ACCESS_KEY    NONAME
Default region name [None]: AP-SOUTH-1
Default output format [None]: json
##################################################################################
########################  AWS CLI INSTALL ON AMAZONE LINUX OS ###################
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
sudo yum install unzip -y && unzip awscliv2.zip
sudo ./aws/install --bin-dir /usr/bin --install-dir /usr/bin/aws_cli --update
aws --version 
which aws

aws configure
$ aws configure
AWS Access Key ID [None]: YOUR_ACCESS_KEY_ID
AWS Secret Access Key [None]: YOUR_SECRET_ACCESS_KEY
Default region name [None]: us-west-2
Default output format [None]: json
####################################################################################
# credentiol find
ls ~/.aws
config credentiols
cd ~/.aws
cat credentiol    #### show u credentiols ########
ACCSSEC
SECRET
cat config
REGION
JSON
cd ~/.aws # env | grep -i aws
##### it show u actuval credentiol### copy past in configur
aws configure
assec key give
secret key give
# add multifull credentiol 
cd ~/.aws
vi credentiol

[default]
aws_access_key_id = key
aws_secret_access_key = key

[QA]
aws_access_key_id = key
aws_secret_access_key = key      

[PROD]
aws_access_key_id = key
aws_secret_access_key = key   
wq!
-------------------------------------------
provider "aws" {
   rigion = "ap-south-1"
   profile = "QA|PROD"      # access/seccret key referered from ~/.aws/credentiol #
---------------------------------------------------
# same QA environ ment can use     alias
# resorce block called   alias
-----------------------------------------------------
# AWS Provider Configuration
provider "aws" {
  region  = "ap-south-1"
  profile = "QA"  # Access/secret key referred from ~/.aws/credentials
  alias   = "mumbai"
}

provider "aws" {
  alias   = "north-virginia"  # Alias name for referral
  region  = "us-east-1"
  profile = "QA"
}

# EC2 Instance Resource in North Virginia
resource "aws_instance" "example" {
  ami           = "ami-02b49a24cfb95941c"  # Specify your AMI ID
  instance_type = "t2.micro"
  provider      = aws.north-virginia  # Alias name to pick the provider
}
########################################################################
#  provider      = aws.mubaie ## this si refferal alias u donat give any name it take[ defualt  ]
   or [  QA   ]   or    [   PROD    ]    
#################################################################################################
##########  importent  u are state file in s3 two person work at the time it problem so one person plan lock apply lock 
this work wen finsh lock is open second person waiting becouse show him it lock wen lock open secound person do work s3 is databace 
in s3 have dynamoDB databace is no colem and tables its Json parmet
##########################################################################################################################
################################  DynamoDB locking statefile in terraform   #################################################
mkdir realtimeproject
cd realproject 
vi main.tf

provider "aws" {
  region = "ap-south-1"              # Replace with your desired region
}

resource "aws_s3_bucket" "example" {
  bucket = "wezvatech-sravan-demo-s3"  # Replace with your desired bucket name
}

resource "aws_dynamodb_table" "dynamodb-terraform-state-locks" {
  name         = "terraform-state-lock-dynamo"  # Replace with your desired table name
  billing_mode = "PROVISIONED"           # Use "PROVISIONED" for fixed read/write capacity
  hash_key = "LockID"
  read_capacity  = 20                    # Set read capacity units
  write_capacity = 20                    # Set write capacity units
  attribute {
    name = "LockID"
    type = "S"
  }

  tags = {
    Name = "DynamoDB Terraform state Lock Table"
  }
}

###########################################################################################################
terraform init validate paln apply
############################################################################################################
mkdir statelock
cd statelock
vi main.tf         
provider "aws" {
  region = "ap-south-1"  
}

# Define an EC2 instance
resource "aws_instance" "example" {
  ami           = "ami-02b49a24cfb95941c" 
  instance_type = "t2.micro"  
}
#################


vi backend.tf
terraform {
  backend "s3" {
    bucket         = "wezvatech-sravan-demo-s3"
    key            = "default/terraform.tfstate"
    region         = "ap-south-1"
    dynamodb_table = "terraform-state-lock-dynamo"
  }
}
####################################################################
cd statelock
terrform init
terrform plan apply
terrfotm plan    uptodate show you
vi main.tf
vi main.tf         
provider "aws" {
  region = "ap-south-1"  
}

# Define an EC2 instance
resource "aws_instance" "example" {
  ami           = "ami-02b49a24cfb95941c" 
  instance_type = "t2.micro" 
  count  =  2    #### i adden this
}
##################################################################
now lock create in dynamodb cancheck affter apply
terrform plan apply
go to dynamodb databace in item can check lock
##############################  ##################################
1.cd stateclock
2.terraform destroy
3. go to s3 bucket only[ delete .statefile] manuvally
4.cd realtimeproject
terraform destroy     # all gone  see check
#####################################################################  DB LOck END  #########

















